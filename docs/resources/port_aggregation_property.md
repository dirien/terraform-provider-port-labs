---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "port_aggregation_property Resource - terraform-provider-port-labs"
subcategory: ""
description: |-
  Aggregation Property
  This resource allows you to manage an aggregation property.
  See the Port documentation https://docs.getport.io/build-your-software-catalog/define-your-data-model/setup-blueprint/properties/aggregation-property/ for more information about aggregation properties.
  Supported Methods:
  count_entities - Count the entities of the target blueprintaverage_entities - Average the entities of the target blueprint by time periodsaveragebyproperty - Calculate the average by property value of the target entitiesaggregatebyproperty - Calculate the aggregate by property value of the target entities, such as sum, min, max, median
  Example Usage
  Create a parent blueprint with a child blueprint and an aggregation property to count the children's:
  ```hcl
  resource "port_blueprint" "parent_blueprint" {
      title = "Parent Blueprint"
      icon = "Terraform"
      identifier = "%s"
      description = ""
      properties = {
          number_props = {
              "age" = {
                  title = "Age"
              }
          }
      }
  }
  
  resource "port_blueprint" "child_blueprint" {
      title = "Child Blueprint"
      icon = "Terraform"
      identifier = "%s"
      description = ""
      properties = {
          number_props = {
              "age" = {
                  title = "Age"
              }
          }
      }
      relations = {
          "parent" = {
               title = "Parent"
               target = port_blueprint.parent_blueprint.identifier
           }
      }
  }
  
  resource "port_aggregation_property" "count_entities" {
      aggregation_identifier = "%s"
      blueprint_identifier = port_blueprint.parent_blueprint.identifier
      target_blueprint_identifier = port_blueprint.child_blueprint.identifier
      title = "Count Childrens"
      icon = "Terraform"
      description = "Count Childrens"
      method = {
          count_entities = true
      }
  }
  
  ```
  Create a parent blueprint with a child blueprint and an aggregation property to calculate the average avg of the children's age:
  ```hcl
  resource "port_blueprint" "parent_blueprint" {
      title = "Parent Blueprint"
      icon = "Terraform"
      identifier = "%s"
      description = ""
      properties = {
          number_props = {
              "age" = {
                  title = "Age"
              }
          }
      }
  }
  
  resource "port_blueprint" "child_blueprint" {
      title = "Child Blueprint"
      icon = "Terraform"
      identifier = "%s"
      description = ""
      properties = {
          number_props = {
              "age" = {
                  title = "Age"
              }
          }
      }
      relations = {
          "parent" = {
               title = "Parent"
               target = port_blueprint.parent_blueprint.identifier
           }
      }
  }
  
  resource "port_aggregation_property" "count_entities" {
      aggregation_identifier = "%s"
      blueprint_identifier = port_blueprint.parent_blueprint.identifier
      target_blueprint_identifier = port_blueprint.child_blueprint.identifier
      title = "Count Childrens"
      icon = "Terraform"
      description = "Count Childrens"
      method = {
          average_by_property = {
              average_of = "total"
              measure_time_by = "$createdAt"
              property = "age"
          }
      }
  }
  
  ```
  Create a repository blueprint and a pull request blueprint and an aggregation property to calculate the average of pull requests created per day:
  ```hcl
  resource "port_blueprint" "repository_blueprint" {
      title = "Repository Blueprint"
      icon = "Terraform"
      identifier = "%s"
      description = ""    
  }
  
  resource "port_blueprint" "pull_request_blueprint" {
      title = "Pull Request Blueprint"
      icon = "Terraform"  
      identifier = "%s"   
      description = ""
      properties = {
          string_props = {
              "status" = {
                  title = "Status"
              }   
          }
      }
      relations = {
          "repository" = {
              title = "Repository"
              target = port_blueprint.repository_blueprint.identifier
          }
      }
  }
  
  resource "port_aggregation_property" "pull_requests_per_day" {
      aggregation_identifier = "%s"   
      blueprint_identifier = port_blueprint.repository_blueprint.identifier   
      target_blueprint_identifier = port_blueprint.pull_request_blueprint.identifier  
      title = "Pull Requests Per Day" 
      icon = "Terraform"  
      description = "Pull Requests Per Day"
      method = {  
          average_entities = {
              average_of = "day"
              measure_time_by = "$createdAt"
          }
      }
  }
  
  ```
  Create a repository blueprint and a pull request blueprint and an aggregation property to calculate the average of fix pull request per month:
  To do that we will add a query to the aggregation property to filter only pull requests with fixed title:
  ```hcl
  resource "port_blueprint" "repository_blueprint" {
      title = "Repository Blueprint"  
      icon = "Terraform"
      identifier = "%s"   
      description = ""    
  }
  
  resource "port_blueprint" "pull_request_blueprint" {
      title = "Pull Request Blueprint"
      icon = "Terraform"  
      identifier = "%s"   
      description = ""    
      properties = {
          string_props = {    
              "status" = {
                  title = "Status"
              }
          }
      }   
      relations = {   
          "repository" = {
              title = "Repository"    
              target = port_blueprint.repository_blueprint.identifier 
          }
      }   
  }
  
  resource "port_aggregation_property" "pull_requests_per_day" {
      aggregation_identifier = "%s"   
      blueprint_identifier = port_blueprint.repository_blueprint.identifier   
      target_blueprint_identifier = port_blueprint.pull_request_blueprint.identifier  
      title = "Pull Requests Per Day"
      icon = "Terraform"  
      description = "Pull Requests Per Day"
      method = {  
          average_entities = {
              average_of = "month"
              measure_time_by = "$createdAt"
          }
      }
      query = jsonencode(
          {
              "combinator": "and",
              "rules": [
                  {
                      "property": "$title",
                      "operator": "ContainsAny",
                      "value": ["fix", "fixed", "fixing", "Fix"]
                  }
              ]
          }
      )
  }
  
  ```
---

# port_aggregation_property (Resource)

# Aggregation Property

This resource allows you to manage an aggregation property.

See the [Port documentation](https://docs.getport.io/build-your-software-catalog/define-your-data-model/setup-blueprint/properties/aggregation-property/) for more information about aggregation properties.


Supported Methods:

- count_entities - Count the entities of the target blueprint
- average_entities - Average the entities of the target blueprint by time periods
- average_by_property - Calculate the average by property value of the target entities
- aggregate_by_property - Calculate the aggregate by property value of the target entities, such as sum, min, max, median

## Example Usage

Create a parent blueprint with a child blueprint and an aggregation property to count the children's:

```hcl

	resource "port_blueprint" "parent_blueprint" {
		title = "Parent Blueprint"
		icon = "Terraform"
		identifier = "%s"
		description = ""
		properties = {
			number_props = {
				"age" = {
					title = "Age"
				}
			}
		}
	}

	resource "port_blueprint" "child_blueprint" {
		title = "Child Blueprint"
		icon = "Terraform"
		identifier = "%s"
		description = ""
		properties = {
			number_props = {
				"age" = {
					title = "Age"
				}
			}
		}
       	relations = {
            "parent" = {
				 title = "Parent"
				 target = port_blueprint.parent_blueprint.identifier
			 }
		}
	}

	resource "port_aggregation_property" "count_entities" {
		aggregation_identifier = "%s"
		blueprint_identifier = port_blueprint.parent_blueprint.identifier
		target_blueprint_identifier = port_blueprint.child_blueprint.identifier
		title = "Count Childrens"
		icon = "Terraform"
		description = "Count Childrens"
		method = {
			count_entities = true
		}
	}
```

Create a parent blueprint with a child blueprint and an aggregation property to calculate the average avg of the children's age:

```hcl

	resource "port_blueprint" "parent_blueprint" {
		title = "Parent Blueprint"
		icon = "Terraform"
		identifier = "%s"
		description = ""
		properties = {
			number_props = {
				"age" = {
					title = "Age"
				}
			}
		}
	}

	resource "port_blueprint" "child_blueprint" {
		title = "Child Blueprint"
		icon = "Terraform"
		identifier = "%s"
		description = ""
		properties = {
			number_props = {
				"age" = {
					title = "Age"
				}
			}
		}
       	relations = {
            "parent" = {
				 title = "Parent"
				 target = port_blueprint.parent_blueprint.identifier
			 }
		}
	}

	resource "port_aggregation_property" "count_entities" {
		aggregation_identifier = "%s"
		blueprint_identifier = port_blueprint.parent_blueprint.identifier
		target_blueprint_identifier = port_blueprint.child_blueprint.identifier
		title = "Count Childrens"
		icon = "Terraform"
		description = "Count Childrens"
		method = {
			average_by_property = {
				average_of = "total"
				measure_time_by = "$createdAt"
				property = "age"
            }
		}
	}

```

Create a repository blueprint and a pull request blueprint and an aggregation property to calculate the average of pull requests created per day:

```hcl

	resource "port_blueprint" "repository_blueprint" {
		title = "Repository Blueprint"
		icon = "Terraform"
		identifier = "%s"
		description = ""	
	}
	
	resource "port_blueprint" "pull_request_blueprint" {
		title = "Pull Request Blueprint"
		icon = "Terraform"	
		identifier = "%s"	
		description = ""
		properties = {
			string_props = {
				"status" = {
					title = "Status"
				}	
			}
		}
		relations = {
			"repository" = {
				title = "Repository"
				target = port_blueprint.repository_blueprint.identifier
			}
		}
	}

	resource "port_aggregation_property" "pull_requests_per_day" {
		aggregation_identifier = "%s"	
		blueprint_identifier = port_blueprint.repository_blueprint.identifier	
		target_blueprint_identifier = port_blueprint.pull_request_blueprint.identifier	
		title = "Pull Requests Per Day"	
		icon = "Terraform"	
		description = "Pull Requests Per Day"
		method = {	
			average_entities = {
				average_of = "day"
				measure_time_by = "$createdAt"
			}
		}
	}
	
```

Create a repository blueprint and a pull request blueprint and an aggregation property to calculate the average of fix pull request per month:

To do that we will add a query to the aggregation property to filter only pull requests with fixed title:

```hcl

	resource "port_blueprint" "repository_blueprint" {
		title = "Repository Blueprint"	
		icon = "Terraform"
		identifier = "%s"	
		description = ""	
	}
	
	resource "port_blueprint" "pull_request_blueprint" {
		title = "Pull Request Blueprint"
		icon = "Terraform"	
		identifier = "%s"	
		description = ""	
		properties = {
			string_props = {	
				"status" = {
					title = "Status"
				}
			}
		}	
		relations = {	
			"repository" = {
				title = "Repository"	
				target = port_blueprint.repository_blueprint.identifier	
			}
		}	
	}

	resource "port_aggregation_property" "pull_requests_per_day" {
		aggregation_identifier = "%s"	
		blueprint_identifier = port_blueprint.repository_blueprint.identifier	
		target_blueprint_identifier = port_blueprint.pull_request_blueprint.identifier	
		title = "Pull Requests Per Day"
		icon = "Terraform"	
		description = "Pull Requests Per Day"
		method = {	
			average_entities = {
				average_of = "month"
				measure_time_by = "$createdAt"
			}
		}
		query = jsonencode(
			{
				"combinator": "and",
				"rules": [
					{
						"property": "$title",
					  	"operator": "ContainsAny",
					  	"value": ["fix", "fixed", "fixing", "Fix"]
					}
				]
			}
		)
	}

```



<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `aggregation_identifier` (String) The identifier of the aggregation property in the blueprint
- `blueprint_identifier` (String) The identifier of the blueprint the aggregation property will be added to
- `method` (Attributes) The aggregation method to perform on the target blueprint, one of count_entities, average_entities, average_by_property, aggregate_by_property (see [below for nested schema](#nestedatt--method))
- `target_blueprint_identifier` (String) The identifier of the blueprint to perform the aggregation on

### Optional

- `description` (String) The description of the aggregation property
- `icon` (String) The icon of the aggregation property
- `query` (String) Query to filter the target entities
- `title` (String) The title of the aggregation property

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedatt--method"></a>
### Nested Schema for `method`

Optional:

- `aggregate_by_property` (Attributes) Function to calculate the aggregate by property value of the target entities, such as sum, min, max, median (see [below for nested schema](#nestedatt--method--aggregate_by_property))
- `average_by_property` (Attributes) Function to calculate the average by property value of the target entities (see [below for nested schema](#nestedatt--method--average_by_property))
- `average_entities` (Attributes) Function to average the entities of the target entities (see [below for nested schema](#nestedatt--method--average_entities))
- `count_entities` (Boolean) Function to count the entities of the target entities

<a id="nestedatt--method--aggregate_by_property"></a>
### Nested Schema for `method.aggregate_by_property`

Required:

- `func` (String) The func of the aggregate by property
- `property` (String) The property of the aggregate by property


<a id="nestedatt--method--average_by_property"></a>
### Nested Schema for `method.average_by_property`

Required:

- `average_of` (String) The time periods to calculate the average by, e.g. hour, day, week, month
- `measure_time_by` (String) The property name on which to calculate the the time periods, e.g. $createdAt, $updated_at or any other date property
- `property` (String) The property name on which to calculate the average by


<a id="nestedatt--method--average_entities"></a>
### Nested Schema for `method.average_entities`

Optional:

- `average_of` (String) The time periods to calculate the average of, e.g. hour, day, week, month
- `measure_time_by` (String) The property name on which to calculate the the time periods, e.g. $createdAt, $updated_at or any other date property
